"use strict";!function(t,n){"function"==typeof define&&define.amd?define(["es6-promise","base-64","utf8","axios"],function(e,o,s,i){return t.Github=n(e,o,s,i)}):"object"==typeof module&&module.exports?module.exports=n(require("es6-promise"),require("base-64"),require("utf8"),require("axios")):t.Github=n(t.Promise,t.base64,t.utf8,t.axios)}(this,function(t,n,e,o){function s(t){return n.encode(e.encode(t))}t.polyfill&&t.polyfill();var i=function(t){var n=t.apiUrl||"https://api.github.com",e=i._request=function(e,i,u,r,c){function a(){var t=i.indexOf("//")>=0?i:n+i;if(t+=/\?/.test(t)?"&":"?",u&&"object"==typeof u&&["GET","HEAD","DELETE"].indexOf(e)>-1)for(var o in u)u.hasOwnProperty(o)&&(t+="&"+encodeURIComponent(o)+"="+encodeURIComponent(u[o]));return t+("undefined"!=typeof window?"&"+(new Date).getTime():"")}var l={headers:{Accept:c?"application/vnd.github.v3.raw+json":"application/vnd.github.v3+json","Content-Type":"application/json;charset=UTF-8"},method:e,data:u?u:{},url:a()};return(t.token||t.username&&t.password)&&(l.headers.Authorization=t.token?"token "+t.token:"Basic "+s(t.username+":"+t.password)),o(l).then(function(t){r(null,t.data||!0,t)},function(t){304===t.status?r(null,t.data||!0,t):r({path:i,request:t.data,error:t.status})})},u=i._requestAllPages=function(t,n){var o=[];!function s(){e("GET",t,null,function(e,i,u){if(e)return n(e);o.push.apply(o,i);var r=(u.headers.link||"").split(/\s*,\s*/g),c=null;r.forEach(function(t){c=/rel="next"/.test(t)?t:c}),c&&(c=(/<(.*)>/.exec(c)||[])[1]),c?(t=c,s()):n(e,o)})}()};return i.User=function(){this.repos=function(t,n){1===arguments.length&&"function"==typeof arguments[0]&&(n=t,t={}),t=t||{};var o="/user/repos",s=[];s.push("type="+encodeURIComponent(t.type||"all")),s.push("sort="+encodeURIComponent(t.sort||"updated")),s.push("per_page="+encodeURIComponent(t.per_page||"100")),t.page&&s.push("page="+encodeURIComponent(t.page)),o+="?"+s.join("&"),e("GET",o,null,n)},this.orgs=function(t){e("GET","/user/orgs",null,t)},this.gists=function(t){e("GET","/gists",null,t)},this.notifications=function(t,n){1===arguments.length&&"function"==typeof arguments[0]&&(n=t,t={}),t=t||{};var o="/notifications",s=[];if(t.all&&s.push("all=true"),t.participating&&s.push("participating=true"),t.since){var i=t.since;i.constructor===Date&&(i=i.toISOString()),s.push("since="+encodeURIComponent(i))}if(t.before){var u=t.before;u.constructor===Date&&(u=u.toISOString()),s.push("before="+encodeURIComponent(u))}t.page&&s.push("page="+encodeURIComponent(t.page)),s.length>0&&(o+="?"+s.join("&")),e("GET",o,null,n)},this.show=function(t,n){var o=t?"/users/"+t:"/user";e("GET",o,null,n)},this.userRepos=function(t,n){u("/users/"+t+"/repos?type=all&per_page=100&sort=updated",n)},this.userStarred=function(t,n){u("/users/"+t+"/starred?type=all&per_page=100",function(t,e){n(t,e)})},this.userGists=function(t,n){e("GET","/users/"+t+"/gists",null,n)},this.orgRepos=function(t,n){u("/orgs/"+t+"/repos?type=all&&page_num=1000&sort=updated&direction=desc",n)},this.follow=function(t,n){e("PUT","/user/following/"+t,null,n)},this.unfollow=function(t,n){e("DELETE","/user/following/"+t,null,n)},this.createRepo=function(t,n){e("POST","/user/repos",t,n)}},i.Repository=function(t){function n(t,n){return t===l.branch&&l.sha?n(null,l.sha):void a.getRef("heads/"+t,function(e,o){l.branch=t,l.sha=o,n(e,o)})}var o,u=t.name,r=t.user,c=t.fullname,a=this;o=c?"/repos/"+c:"/repos/"+r+"/"+u;var l={branch:null,sha:null};this.deleteRepo=function(n){e("DELETE",o,t,n)},this.getRef=function(t,n){e("GET",o+"/git/refs/"+t,null,function(t,e,o){return t?n(t):void n(null,e.object.sha,o)})},this.createRef=function(t,n){e("POST",o+"/git/refs",t,n)},this.deleteRef=function(n,s){e("DELETE",o+"/git/refs/"+n,t,function(t,n,e){s(t,n,e)})},this.createRepo=function(t,n){e("POST","/user/repos",t,n)},this.deleteRepo=function(n){e("DELETE",o,t,n)},this.listTags=function(t){e("GET",o+"/tags",null,function(n,e,o){return n?t(n):void t(null,e,o)})},this.listPulls=function(t,n){t=t||{};var s=o+"/pulls",i=[];"string"==typeof t?i.push("state="+t):(t.state&&i.push("state="+encodeURIComponent(t.state)),t.head&&i.push("head="+encodeURIComponent(t.head)),t.base&&i.push("base="+encodeURIComponent(t.base)),t.sort&&i.push("sort="+encodeURIComponent(t.sort)),t.direction&&i.push("direction="+encodeURIComponent(t.direction)),t.page&&i.push("page="+t.page),t.per_page&&i.push("per_page="+t.per_page)),i.length>0&&(s+="?"+i.join("&")),e("GET",s,null,function(t,e,o){return t?n(t):void n(null,e,o)})},this.getPull=function(t,n){e("GET",o+"/pulls/"+t,null,function(t,e,o){return t?n(t):void n(null,e,o)})},this.compare=function(t,n,s){e("GET",o+"/compare/"+t+"..."+n,null,function(t,n,e){return t?s(t):void s(null,n,e)})},this.listBranches=function(t){e("GET",o+"/git/refs/heads",null,function(n,e,o){return n?t(n):void t(null,e.map(function(t){return t.ref.replace(/^refs\/heads\//,"")}),o)})},this.getBlob=function(t,n){e("GET",o+"/git/blobs/"+t,null,n,"raw")},this.getCommit=function(t,n,s){e("GET",o+"/git/commits/"+n,null,function(t,n,e){return t?s(t):void s(null,n,e)})},this.getSha=function(t,n,s){return n&&""!==n?void e("GET",o+"/contents/"+n+(t?"?ref="+t:""),null,function(t,n,e){return t?s(t):void s(null,n.sha,e)}):a.getRef("heads/"+t,s)},this.getStatuses=function(t,n){e("GET",o+"/statuses/"+t,null,n)},this.getTree=function(t,n){e("GET",o+"/git/trees/"+t,null,function(t,e,o){return t?n(t):void n(null,e.tree,o)})},this.postBlob=function(t,n){t="string"==typeof t?{content:t,encoding:"utf-8"}:{content:s(t),encoding:"base64"},e("POST",o+"/git/blobs",t,function(t,e){return t?n(t):void n(null,e.sha)})},this.updateTree=function(t,n,s,i){var u={base_tree:t,tree:[{path:n,mode:"100644",type:"blob",sha:s}]};e("POST",o+"/git/trees",u,function(t,n){return t?i(t):void i(null,n.sha)})},this.postTree=function(t,n){e("POST",o+"/git/trees",{tree:t},function(t,e){return t?n(t):void n(null,e.sha)})},this.commit=function(n,s,u,r){var c=new i.User;c.show(null,function(i,c){if(i)return r(i);var a={message:u,author:{name:t.user,email:c.email},parents:[n],tree:s};e("POST",o+"/git/commits",a,function(t,n){return t?r(t):(l.sha=n.sha,void r(null,n.sha))})})},this.updateHead=function(t,n,s){e("PATCH",o+"/git/refs/heads/"+t,{sha:n},function(t){s(t)})},this.show=function(t){e("GET",o,null,t)},this.contributors=function(t,n){n=n||1e3;var s=this;e("GET",o+"/stats/contributors",null,function(e,o,i){return e?t(e):void(202===i.status?setTimeout(function(){s.contributors(t,n)},n):t(e,o,i))})},this.contents=function(t,n,s){n=encodeURI(n),e("GET",o+"/contents"+(n?"/"+n:""),{ref:t},s)},this.fork=function(t){e("POST",o+"/forks",null,t)},this.listForks=function(t){e("GET",o+"/forks",null,t)},this.branch=function(t,n,e){2===arguments.length&&"function"==typeof arguments[1]&&(e=n,n=t,t="master"),this.getRef("heads/"+t,function(t,o){return t&&e?e(t):void a.createRef({ref:"refs/heads/"+n,sha:o},e)})},this.createPullRequest=function(t,n){e("POST",o+"/pulls",t,n)},this.listHooks=function(t){e("GET",o+"/hooks",null,t)},this.getHook=function(t,n){e("GET",o+"/hooks/"+t,null,n)},this.createHook=function(t,n){e("POST",o+"/hooks",t,n)},this.editHook=function(t,n,s){e("PATCH",o+"/hooks/"+t,n,s)},this.deleteHook=function(t,n){e("DELETE",o+"/hooks/"+t,null,n)},this.read=function(t,n,s){e("GET",o+"/contents/"+encodeURI(n)+(t?"?ref="+t:""),null,function(t,n,e){return t&&404===t.error?s("not found",null,null):t?s(t):void s(null,n,e)},!0)},this.remove=function(t,n,s){a.getSha(t,n,function(i,u){return i?s(i):void e("DELETE",o+"/contents/"+n,{message:n+" is removed",sha:u,branch:t},s)})},this["delete"]=this.remove,this.move=function(t,e,o,s){n(t,function(n,i){a.getTree(i+"?recursive=true",function(n,u){u.forEach(function(t){t.path===e&&(t.path=o),"tree"===t.type&&delete t.sha}),a.postTree(u,function(n,o){a.commit(i,o,"Deleted "+e,function(n,e){a.updateHead(t,e,function(t){s(t)})})})})})},this.write=function(t,n,i,u,r,c){"undefined"==typeof c&&(c=r,r={}),a.getSha(t,encodeURI(n),function(a,l){var f={message:u,content:"undefined"==typeof r.encode||r.encode?s(i):i,branch:t,committer:r&&r.committer?r.committer:void 0,author:r&&r.author?r.author:void 0};a&&404!==a.error||(f.sha=l),e("PUT",o+"/contents/"+encodeURI(n),f,c)})},this.getCommits=function(t,n){t=t||{};var s=o+"/commits",i=[];if(t.sha&&i.push("sha="+encodeURIComponent(t.sha)),t.path&&i.push("path="+encodeURIComponent(t.path)),t.since){var u=t.since;u.constructor===Date&&(u=u.toISOString()),i.push("since="+encodeURIComponent(u))}if(t.until){var r=t.until;r.constructor===Date&&(r=r.toISOString()),i.push("until="+encodeURIComponent(r))}t.page&&i.push("page="+t.page),t.perpage&&i.push("per_page="+t.perpage),i.length>0&&(s+="?"+i.join("&")),e("GET",s,null,n)}},i.Gist=function(t){var n=t.id,o="/gists/"+n;this.read=function(t){e("GET",o,null,t)},this.create=function(t,n){e("POST","/gists",t,n)},this["delete"]=function(t){e("DELETE",o,null,t)},this.fork=function(t){e("POST",o+"/fork",null,t)},this.update=function(t,n){e("PATCH",o,t,n)},this.star=function(t){e("PUT",o+"/star",null,t)},this.unstar=function(t){e("DELETE",o+"/star",null,t)},this.isStarred=function(t){e("GET",o+"/star",null,t)}},i.Issue=function(t){var n="/repos/"+t.user+"/"+t.repo+"/issues";this.list=function(t,e){var o=[];for(var s in t)t.hasOwnProperty(s)&&o.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));u(n+"?"+o.join("&"),e)},this.comment=function(t,n,o){e("POST",t.comments_url,{body:n},function(t,n){o(t,n)})}},i.Search=function(t){var n="/search/",o="?q="+t.query;this.repositories=function(t,s){e("GET",n+"repositories"+o,t,s)},this.code=function(t,s){e("GET",n+"code"+o,t,s)},this.issues=function(t,s){e("GET",n+"issues"+o,t,s)},this.users=function(t,s){e("GET",n+"users"+o,t,s)}},i};return i.getIssues=function(t,n){return new i.Issue({user:t,repo:n})},i.getRepo=function(t,n){return n?new i.Repository({user:t,name:n}):new i.Repository({fullname:t})},i.getUser=function(){return new i.User},i.getGist=function(t){return new i.Gist({id:t})},i.getSearch=function(t){return new i.Search({query:t})},i});
//# sourceMappingURL=github.min.js.map
